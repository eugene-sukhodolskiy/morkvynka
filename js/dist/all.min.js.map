{"version":3,"sources":["app.js"],"names":["refreshCartBtnByRemoveBtn","document","querySelectorAll","forEach","i","addEventListener","e","setTimeout","cart_btn_control","jQuery","ajax","type","url","data","action","success","total","JSON","parse","Object","keys","length","cartBtn","querySelector","innerHTML","classList","add","remove","error","console","log","dmenu","currentTarget","parentNode","contains","preventDefault","click","product_id","this","btn","let","wc_add_to_cart_params","ajax_url","response","cont","createElement","cart_item_key","fragments","getAttribute","attr"],"mappings":"AAuEA,SAAAA,4BACAC,SAAAC,iBAAA,yBAAA,EAAAC,QAAAC,GAAAA,EAAAC,iBACA,QACAC,GAAAC,WAAA,KACAP,0BAAA,EACAQ,iBAAA,CACA,EAAA,GAAA,CACA,CAAA,CACA,CAEA,SAAAA,mBACAC,OAAAC,KAAA,CACAC,KAAA,OACAC,IAAA,2BACAC,KAAA,CACAC,OAAA,mBACA,EACAC,QAAA,SAAAF,GAEA,IAAAG,EAAA,UAAA,OADAH,EAAAI,KAAAC,MAAAL,CAAA,GACAM,OAAAC,KAAAP,CAAA,EAAAQ,OAAA,EACAC,EAAArB,SAAAsB,cAAA,cAAA,EACAP,GACAM,EAAAC,cAAA,UAAA,EAAAC,UAAA,EAAAR,EAAA,KAAAA,EACAM,EAAAG,UAAAC,IAAA,MAAA,GAEAJ,EAAAG,UAAAE,OAAA,MAAA,CAEA,EACAC,MAAA,SAAAA,GACAC,QAAAC,IAAAF,CAAA,CACA,CACA,CAAA,CACA,CAvGA3B,SAAAI,iBAAA,mBAAAC,IACAL,SAAAC,iBAAA,2BAAA,EAAAC,QAAAC,IACAA,EAAAC,iBAAA,QAAAC,IACA,MAAAyB,EAAAzB,EAAA0B,cAAAC,WAAAV,cAAA,kBAAA,EACAhB,WAAA,KACAwB,EAAAN,UAAAS,SAAA,MAAA,EACAH,EAAAN,UAAAE,OAAA,MAAA,EAEAI,EAAAN,UAAAC,IAAA,MAAA,CAEA,EAAA,EAAA,CACA,CAAA,CACA,CAAA,EAEAzB,SAAAI,iBACA,QACAC,GAAAL,SAAAC,iBAAA,qBAAA,EAAAC,QAAAC,GAAAA,EAAAqB,UAAAE,OAAA,MAAA,CAAA,CACA,EAEA1B,SAAAC,iBAAA,0BAAA,EAAAC,QAAAC,GAAAA,EAAAC,iBAAA,QAAAC,GAAAA,EAAA6B,eAAA,CAAA,CAAA,EAEA1B,OAAA,cAAA,EAAA2B,MAAA,SAAA9B,GACAA,EAAA6B,eAAA,EACA,IAAAE,EAAA5B,OAAA6B,IAAA,EAAAzB,KAAA,YAAA,EACA,MAAA0B,EAAAD,KACAE,IAAA3B,EAAA,CACAC,OAAA,0BACAuB,WAAAA,CACA,EACA,GAAAE,EAAAd,UAAAS,SAAA,SAAA,EAEA,MAAA,CAAA,EAUAK,EAAAd,UAAAC,IAAA,SAAA,EAGAjB,OAAAC,KAAA,CACAE,IAAA6B,sBAAAC,SACA/B,KAAA,OACAE,KAAAA,EACAE,QAAA,SAAA4B,GACA,IAAAC,EAAA3C,SAAA4C,cAAA,KAAA,EAEAC,GADAF,EAAApB,UAAAmB,EAAAI,UAAA,oCACAH,EAAArB,cAAA,uBAAA,EAAAyB,aAAA,oBAAA,GACAvC,OAAA8B,CAAA,EAAAU,KAAA,qBAAAH,CAAA,EACAjB,QAAAC,IAAAO,EAAA,oBAAA,EACA7B,iBAAA,CACA,EACAoB,MAAA,SAAAA,GACAW,EAAAd,UAAAS,SAAA,SAAA,EACAK,EAAAd,UAAAE,OAAA,SAAA,EAEAY,EAAAd,UAAAC,IAAA,SAAA,EAEAG,QAAAD,WAAAS,iBAAA,CACA,CACA,CAAA,CACA,CAAA,EAEArC,0BAAA,EACAQ,iBAAA,CACA,CAAA","file":"all.min.js","sourcesContent":["document.addEventListener(\"DOMContentLoaded\", e => {\n\tdocument.querySelectorAll(\".dropdown-toggle.nav-link\").forEach(i => {\n\t\ti.addEventListener(\"click\", e => {\n\t\t\tconst dmenu = e.currentTarget.parentNode.querySelector(\"ul.dropdown-menu\");\n\t\t\tsetTimeout(() => {\n\t\t\t\tif(dmenu.classList.contains(\"show\")) {\n\t\t\t\t\tdmenu.classList.remove(\"show\");\n\t\t\t\t}else {\n\t\t\t\t\tdmenu.classList.add(\"show\");\n\t\t\t\t}\n\t\t\t}, 50);\n\t\t});\n\t})\n\n\tdocument.addEventListener(\n\t\t\"click\", \n\t\te => document.querySelectorAll(\".dropdown-menu.show\").forEach(i => i.classList.remove(\"show\"))\n\t);\n\n\tdocument.querySelectorAll(`[data-toggle=\"dropdown\"]`).forEach(i => i.addEventListener(\"click\", e => e.preventDefault()))\n\n\tjQuery('.add-to-cart').click(function(e) {\n    e.preventDefault();\n    var product_id = jQuery(this).data('product_id');\n  \tconst btn = this;\n  \tlet data = {\n      'action': 'woocommerce_add_to_cart',\n      'product_id': product_id,\n    };\n  \tif(btn.classList.contains(\"already\")){\n  \t\t// Заглушка \n  \t\treturn false;\n\n  \t\tdata = {\n        'action': 'woocommerce_remove_cart_item',\n      \t'product_id': product_id,\n      \t'quantity': 10,\n        'cart_item_key': btn.getAttribute(\"data-cart_item_key\")\n      }\n  \t\tbtn.classList.remove(\"already\");\n  \t} else {\n\t\t\tbtn.classList.add(\"already\");\n  \t}\n\n    jQuery.ajax({\n      url: wc_add_to_cart_params.ajax_url,\n      type: 'POST',\n      data: data,\n      success: function(response) {\n      \tconst cont = document.createElement(\"DIV\");\n      \tcont.innerHTML = response.fragments[\"div.widget_shopping_cart_content\"];\n      \tconst cart_item_key = cont.querySelector(\"a[data-cart_item_key]\").getAttribute(\"data-cart_item_key\");\n      \tjQuery(btn).attr(\"data-cart_item_key\", cart_item_key);\n        console.log(`${product_id} was added to cart`)\n        cart_btn_control();\n      },\n      error: function(error) {\n  \t\t\tif(btn.classList.contains(\"already\")){\n\t\t  \t\tbtn.classList.remove(\"already\");\n\t\t  \t} else {\n\t\t\t\t\tbtn.classList.add(\"already\");\n\t\t  \t}\n        console.error(`ID${product_id} Operation err`)\n      }\n    });\n\t});\n\n\trefreshCartBtnByRemoveBtn();\n\tcart_btn_control();\n});\n\nfunction refreshCartBtnByRemoveBtn() {\n\tdocument.querySelectorAll(\".product-remove .remove\").forEach(i => i.addEventListener(\n\t\t\"click\", \n\t\te => setTimeout(() => {\n\t\t\trefreshCartBtnByRemoveBtn();\n\t\t\tcart_btn_control();\n\t\t}, 2000)\n\t))\n}\n\nfunction cart_btn_control() {\n\tjQuery.ajax({\n    type: 'POST',\n    url: '/wp-admin/admin-ajax.php',\n    data: {\n      action: 'get_cart_contents'\n    },\n    success: function (data) {\n    \tdata = JSON.parse(data);\n    \tconst total = typeof data == \"object\" ? Object.keys(data).length : 0;\n    \tconst cartBtn = document.querySelector(\".go-cart-btn\");\n    \tif(total) {\n\t\t\t\tcartBtn.querySelector(\".counter\").innerHTML = total > 9 ? \"9+\" : total;\n\t\t\t\tcartBtn.classList.add(\"show\");\n    \t} else {\n\t\t\t\tcartBtn.classList.remove(\"show\");\n    \t}\n    },\n    error: function (error) {\n      console.log(error);\n    }\n\t});\n}"]}